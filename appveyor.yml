version: 0.1.{build}

platform:
  - x64
configuration:
  - Debug

before_build:
  - md build\Win64 
  - cd build\Win64
  - cmake -G "Visual Studio 14 2015 Win64" ..\.. 
  - cmake -DCMAKE_INSTALL_PREFIX=publish .
  - cd ..\..

build_script:
  - msbuild dimcli.sln /m /v:minimal /p:Configuration=Debug
  - msbuild dimcli.sln /m /v:minimal /p:Configuration=RelWithDebInfo

after_build:
  - cd ..\..
  - cmake --build . --target install
  - cd build\Win64\publish
  - 7z a dimcli-latest.zip include lib
  - cd ..\..

artifacts:
  - path: build\Win64\publish\dimcli-latest.zip
    name: dimcli
    type: zip

test_script:
  - build\Win64\bin\clitest

#deploy:
#  tag: latest
#  description: continuous trunk build - $(appveyor_build_version)
#  provider: GitHub
#  auth_token:
#    secure: yheCA/FJ+f7CL84HoPf9MapOlDZQmrGyiqlwFeeIhxvdOudQisUdOyZuWfwq3lUU
#  prerelease: true
#  draft: false
#  force_update: true
